<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>mp-psi example</title>
  </head>
  <body>
    <script type="module">
      import init, { state0_bindgen, state1_bindgen } from "./pkg/mp_psi.js";

      function randomBitVector(hammingWeight, size) {
        let bitVector = new Array(size).fill(0);

        for (let i = 0; i < hammingWeight; i++) {
            let sampleIndex;
            do {
                sampleIndex = Math.floor(Math.random() * size);
            } while (bitVector[sampleIndex] === 1);

            bitVector[sampleIndex] = 1;
        }
        return bitVector;
      }

      init().then(() => {
        const state0 = state0_bindgen();        
        // Generate a random bit vector
        const hammingWeight = 3;
        const size = 10;
        const bitVector = randomBitVector(hammingWeight, size);
        const state1 = state1_bindgen(state0.message_a_to_b, bitVector);
        console.log(state1)
      });
    </script>
  </body>
</html>
